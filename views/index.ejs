<!DOCTYPE html>
<html>
<head>
  <title>論文管理</title>
  <link rel="stylesheet" href="/style.css" />
  <style>
    .toggle { cursor: pointer; font-weight: bold; margin-top: 10px; }
    .hidden { display: none; }
    .subcategory { margin-left: 20px; }
    .paper-list { margin-left: 40px; }
  </style>
</head>

<body>
<div id="header"></div>

<script>
fetch('/header.html')
  .then(response => response.text())
  .then(data => document.getElementById('header').innerHTML = data);
</script>

<% categories.forEach(cat => { %>
  <a href="/category/<%= cat %>" class="card-container" style="text-decoration: none; color: inherit;">
    <div class="card">
      <div class="card-link">
        <h2><%= cat %></h2>
        <p><%= papers.filter(p => p.category === cat).length %> 件</p>
      </div>
    
      <% if (latestByCategory[cat]) { %>
        <div class="latest-paper">
          <p>最新論文</p><br />
          <span><%= latestByCategory[cat].title %></span>
        </div>
      <% } %>

      <ul class="subcategory-list">
        <% const subs = [...new Set(papers.filter(p => p.category === cat).map(p => p.subcategory || "未分類"))]; %>
        <% subs.forEach(sub => { %>
          <li><%= sub %></li>
        <% }) %>
      </ul>
    </div>
   </a>
  <br>
  <% }) %>

<div id="footer"></div>
<script>
fetch('footer.html')
  .then(response => response.text())
  .then(data => document.getElementById('footer').innerHTML = data);
</script>

</body>
</html>

