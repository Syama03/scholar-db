<!DOCTYPE html>
<html>
<head>
  <title>論文管理</title>
  <link rel="stylesheet" href="/style.css" />
  <style>
    .toggle { cursor: pointer; font-weight: bold; margin-top: 10px; }
    .hidden { display: none; }
    .subcategory { margin-left: 20px; }
    .paper-list { margin-left: 40px; }
  </style>
</head>

<body>
<div id="header"></div>

<script>
fetch('/header.html')
  .then(response => response.text())
  .then(data => document.getElementById('header').innerHTML = data);
</script>

<% tags.forEach(tag => { %>
  <a href="/tag/<%= encodeURIComponent(tag) %>" class="card-container" style="text-decoration: none; color: inherit;">
    <div class="card">
      <div class="card-link">
        <h2><%= tag %></h2>
        <p><%= papers.filter(p => { try { const t = JSON.parse(p.tags||'[]'); return t.includes(tag); } catch { return (p.tags||'').split(',').map(s=>s.trim()).includes(tag); } }).length %> 件</p>
      </div>

      <% if (latestByTag[tag]) { %>
        <div class="latest-paper">
          <p>最新論文</p><br />
          <span><%= latestByTag[tag].title %></span>
        </div>
      <% } %>

    </div>
   </a>
  <br>
  <% }) %>

<div id="footer"></div>
<script>
fetch('footer.html')
  .then(response => response.text())
  .then(data => document.getElementById('footer').innerHTML = data);
</script>

</body>
</html>

